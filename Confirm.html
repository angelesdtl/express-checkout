<!DOCTYPE html>
<html>
    <head>
        <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    </head>
    <body>
    	<button id="customButton">Pagar</button>
    	<script>
    		document.getElementById('customButton').addEventListener('click', function(e) {
    			// Open Checkout with further options
			    doPayment();
			    e.preventDefault();
			  });
		
		
		function get_access_token(cb){
				$.ajax({
					  type: "POST",
					  url: "https://api.mercadolibre.com/oauth/token",
					  data: {
					  	"grant_type" : "client_credentials",
					  	"client_id" : "2947782563244672", // test user
					  	"client_secret" : "vlFOp8cF0xDsvmn4pz5WLkcBPUtIZ0Rq"
					  },
					  success: function(data, status, xhr){
					  	if(cb) cb(data, status, xhr);
					  },
					  dataType: "json"
					});
			}

    		function doPayment(){

    			var data = {
	              "amount": 2,
	              "reason": "Reloj",
	              "currency_id": "ARS",
	              "installments": 1,
	              "card_token_id": localStorage.getItem("card_token_id"),
	              "payer_email": "payermla01@hotmail.com",
	              "external_reference": "1"
		         };	
				var uri = "https://api.mercadolibre.com/checkout/custom/create_payment?access_token=APP_USR-589615544091125-092710-8809e91b89030c9c1f625c729f0fa819__K_E__-137787120";
				
		        $.ajax({
			        	 url: uri,
			        	 type: "POST",
			                 dataType: "json",
			        	  contentType: "application/json",
			                  timeout : 10000,
			                  data: JSON.stringify(data),
			                  error : function(jqXHR, textStatus, errorThrown) { 
			                    alert(textStatus);
			                },
			                success:function(response){
			                	alert(response);
			                }

		        });
    		}; 
		</script>
    </body>
</html>
